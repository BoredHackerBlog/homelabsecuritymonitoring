<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Suricata logs</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Suricata logs</h1><br/><h1>Suricata Logs<br /></h1><br /><h2>• Logs are stored in /var/log/suricata/<br />• Log files:<br />   ◇ suricata.log - suricata logs<br />   ◇ eve.json - important. contains various events in json format</h2><br /><h2>   ◇ jq (sudo apt install jq) can be used to explore the json logs</h2><br /><br /><h2># cat eve.json  |grep -i signature |jq .alert.signature<br />&quot;ET POLICY GNU/Linux APT User-Agent Outbound likely related to package management&quot;<br />&quot;ET POLICY GNU/Linux APT User-Agent Outbound likely related to package management&quot;<br />&quot;ET POLICY GNU/Linux APT User-Agent Outbound likely related to package management&quot;<br />&quot;ET POLICY GNU/Linux APT User-Agent Outbound likely related to package management&quot;<br />&quot;ET POLICY GNU/Linux APT User-Agent Outbound likely related to package management&quot;</h2><br /><br /><h2>An example alert:<br /></h2><code><h2>{<br />  &quot;timestamp&quot;: &quot;2021-06-26T17:15:33.990439-0400&quot;,<br />  &quot;flow_id&quot;: 1616207349662563,<br />  &quot;in_iface&quot;: &quot;ens19&quot;,<br />  &quot;event_type&quot;: &quot;alert&quot;,<br />  &quot;src_ip&quot;: &quot;10.0.0.201&quot;,<br />  &quot;src_port&quot;: 33204,<br />  &quot;dest_ip&quot;: &quot;91.189.91.38&quot;,<br />  &quot;dest_port&quot;: 80,<br />  &quot;proto&quot;: &quot;TCP&quot;,<br />  &quot;tx_id&quot;: 2,<br />  &quot;alert&quot;: {<br />    &quot;action&quot;: &quot;allowed&quot;,<br />    &quot;gid&quot;: 1,<br />    &quot;signature_id&quot;: 2013504,<br />    &quot;rev&quot;: 6,<br />    &quot;signature&quot;: &quot;ET POLICY GNU/Linux APT User-Agent Outbound likely related to package management&quot;,<br />    &quot;category&quot;: &quot;Not Suspicious Traffic&quot;,<br />    &quot;severity&quot;: 3,<br />    &quot;metadata&quot;: {<br />      &quot;created_at&quot;: [<br />        &quot;2011_08_31&quot;<br />      ],<br />      &quot;former_category&quot;: [<br />        &quot;POLICY&quot;<br />      ],<br />      &quot;updated_at&quot;: [<br />        &quot;2020_04_22&quot;<br />      ]<br />    }<br />  },<br />  &quot;http&quot;: {<br />    &quot;hostname&quot;: &quot;us.archive.ubuntu.com&quot;,<br />    &quot;url&quot;: &quot;/ubuntu/pool/universe/j/jq/jq_1.6-1ubuntu0.20.04.1_amd64.deb&quot;,<br />    &quot;http_user_agent&quot;: &quot;Debian APT-HTTP/1.3 (2.0.2ubuntu0.2) non-interactive&quot;,<br />    &quot;http_method&quot;: &quot;GET&quot;,<br />    &quot;protocol&quot;: &quot;HTTP/1.1&quot;,<br />    &quot;length&quot;: 0<br />  },<br />  &quot;app_proto&quot;: &quot;http&quot;,<br />  &quot;flow&quot;: {<br />    &quot;pkts_toserver&quot;: 94,<br />    &quot;pkts_toclient&quot;: 102,<br />    &quot;bytes_toserver&quot;: 6733,<br />    &quot;bytes_toclient&quot;: 150419,<br />    &quot;start&quot;: &quot;2021-06-26T17:15:33.770915-0400&quot;<br />  }<br />}</h2></code><br /><br /><br /><a href="https://suricata.readthedocs.io/en/suricata-6.0.0/configuration/suricata-yaml.html#event-output">https://suricata.readthedocs.io/en/suricata-6.0.0/configuration/suricata-yaml.html#event-output</a><br /></div>
</body>
</html>
